# Authentication & Password Reset System - Complete Guide

## üìã Table of Contents
1. [System Overview](#system-overview)
2. [Login System](#login-system)
3. [SAP-Style Password Reset](#sap-style-password-reset)
4. [API Reference](#api-reference)
5. [Frontend Integration](#frontend-integration)
6. [Security Features](#security-features)
7. [Error Handling](#error-handling)
8. [Troubleshooting](#troubleshooting)

---

## üîê System Overview

The authentication system implements **SAP-style password reset** functionality with temporary passwords and forced password changes. The system supports both email and employee ID login methods with comprehensive security features.

### üéØ Key Features:
- **Multi-format Login**: Email or Employee ID
- **SAP-style Password Reset**: Temporary password "Init4321"
- **Forced Password Change**: After temporary password usage
- **Token-based Authentication**: JWT-like tokens with 1-hour expiration
- **Comprehensive Validation**: User status, password requirements
- **Email Notifications**: Password reset notifications

---

## üîë Login System

### Frontend ‚Üí Backend Flow

#### 1. **Login Request (Frontend)**
```javascript
// Frontend sends login data
const loginData = {
  action: 'login',
  username: 'user@example.com',  // Email OR Employee ID
  password: 'userPassword123'
};

// HTTP Request
fetch(API_URL, {
  method: 'POST',
  headers: {
    'Content-Type': 'application/x-www-form-urlencoded',
  },
  body: new URLSearchParams(loginData)
})
```

#### 2. **Backend Processing (Code.js)**
```javascript
case 'login':
  const username = params.username;
  const password = params.password;
  
  // Step 1: Authenticate user
  const authResult = authenticateUser(username, password);
  
  if (authResult.status === 'success') {
    // Step 2: Check if password change required
    const requirePasswordChange = userRow[CONFIG.COLUMNS.USER.REQUIRE_PASSWORD_CHANGE];
    
    if (requirePasswordChange === true || requirePasswordChange === 'true') {
      // Return special response for password change
      return {
        status: 'success',
        message: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô',
        requirePasswordChange: true,
        user: {
          empId: userRow[CONFIG.COLUMNS.USER.EMP_ID],
          fullName: userRow[CONFIG.COLUMNS.USER.FULL_NAME_TH],
          email: userRow[CONFIG.COLUMNS.USER.EMAIL],
          role: userRow[CONFIG.COLUMNS.USER.ROLE]
        }
      };
    } else {
      // Normal login success
      return {
        status: 'success',
        message: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
        token: authResult.token,
        user: authResult.user
      };
    }
  } else {
    // Login failed
    return {
      status: 'error',
      message: authResult.message
    };
  }
```

#### 3. **Backend Response Types**

**Success (Normal Login)**:
```json
{
  "status": "success",
  "message": "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "empId": "EMP001",
    "fullName": "‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‡∏£‡∏∞‡∏ö‡∏ö",
    "email": "test@example.com",
    "role": "user",
    "status": 1
  }
}
```

**Success (Password Change Required)**:
```json
{
  "status": "success",
  "message": "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô",
  "requirePasswordChange": true,
  "user": {
    "empId": "EMP001",
    "fullName": "‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‡∏£‡∏∞‡∏ö‡∏ö",
    "email": "test@example.com",
    "role": "user"
  }
}
```

**Error Response**:
```json
{
  "status": "error",
  "message": "‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"
}
```

#### 4. **Frontend Response Handling**
```javascript
const response = await fetch(API_URL, { /* login request */ });
const result = await response.json();

if (result.status === 'success') {
  if (result.requirePasswordChange) {
    // Show password change form
    showPasswordChangeForm(result.user);
  } else {
    // Normal login success
    localStorage.setItem('authToken', result.token);
    localStorage.setItem('userData', JSON.stringify(result.user));
    redirectToMainApp();
  }
} else {
  // Show error message
  showErrorMessage(result.message);
}
```

---

## üîÑ SAP-Style Password Reset

### Complete Password Reset Workflow

#### Step 1: **Request Password Reset (Frontend)**
```javascript
// Frontend sends reset request
const resetData = {
  action: 'resetPassword',
  email: 'user@example.com'
};

fetch(API_URL, {
  method: 'POST',
  headers: {
    'Content-Type': 'application/x-www-form-urlencoded',
  },
  body: new URLSearchParams(resetData)
})
```

#### Step 2: **Backend Processing (PasswordResetService.js)**
```javascript
function resetUserPassword(empId, email) {
  // 1. Find user by email
  const userInfo = findUserByEmail(email);
  
  if (!userInfo) {
    return {
      status: 'error',
      message: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏µ email ‡∏ô‡∏µ‡πâ'
    };
  }
  
  // 2. Generate temporary password hash
  const tempPassword = "Init4321";  // SAP-style temporary password
  const passwordHash = hashPassword(email, empId);
  
  // 3. Update user in Google Sheets
  data[userRowIndex][CONFIG.COLUMNS.USER.PASSWORD] = passwordHash;
  data[userRowIndex][CONFIG.COLUMNS.USER.REQUIRE_PASSWORD_CHANGE] = true;
  data[userRowIndex][CONFIG.COLUMNS.USER.TEMP_PASSWORD] = true;
  
  // 4. Send email notification
  sendPasswordResetEmail(email, userInfo.fullName, tempPassword);
  
  return {
    status: 'success',
    message: '‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß',
    tempPassword: tempPassword  // For development/testing only
  };
}
```

#### Step 3: **Backend Response**
```json
{
  "status": "success",
  "message": "‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß",
  "empId": "EMP001",
  "email": "user@example.com"
}
```

#### Step 4: **Login with Temporary Password**
```javascript
// User logs in with temporary password
const tempLoginData = {
  action: 'login',
  username: 'user@example.com',
  password: 'Init4321'  // Temporary password
};

// Backend response will include requirePasswordChange: true
```

#### Step 5: **Change Password (Frontend)**
```javascript
// Frontend sends password change request
const changePasswordData = {
  action: 'changePassword',
  empId: 'EMP001',
  currentPassword: 'Init4321',
  newPassword: 'MyNewSecurePassword123'
};

fetch(API_URL, {
  method: 'POST',
  headers: {
    'Content-Type': 'application/x-www-form-urlencoded',
  },
  body: new URLSearchParams(changePasswordData)
})
```

#### Step 6: **Backend Password Change Processing**
```javascript
function changeUserPassword(empId, currentPassword, newPassword) {
  // 1. Find user by empId
  const userRowIndex = findUserRowIndex(empId);
  
  // 2. Verify current password
  const currentPasswordHash = hashPassword(userEmail, empId);
  if (userRow[CONFIG.COLUMNS.USER.PASSWORD] !== currentPasswordHash) {
    return {
      status: 'error',
      message: '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'
    };
  }
  
  // 3. Generate new password hash
  const newPasswordHash = generateNewPasswordHash(newPassword, userEmail, empId);
  
  // 4. Update user record
  data[userRowIndex][CONFIG.COLUMNS.USER.PASSWORD] = newPasswordHash;
  data[userRowIndex][CONFIG.COLUMNS.USER.REQUIRE_PASSWORD_CHANGE] = false;
  data[userRowIndex][CONFIG.COLUMNS.USER.TEMP_PASSWORD] = false;
  
  return {
    status: 'success',
    message: '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß'
  };
}
```

#### Step 7: **Final Login (Normal)**
```javascript
// User can now login normally with new password
const finalLoginData = {
  action: 'login',
  username: 'user@example.com',
  password: 'MyNewSecurePassword123'  // New password
};

// Backend response will be normal login success (no requirePasswordChange)
```

---

## üåê API Reference

### Authentication Endpoints

#### **POST /exec?action=login**
**Purpose**: User authentication

**Request Parameters**:
```javascript
{
  action: 'login',
  username: string,  // Email or Employee ID
  password: string
}
```

**Response Types**:
1. **Normal Success**:
   ```json
   {
     "status": "success",
     "message": "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
     "token": "auth_token_here",
     "user": { /* user object */ }
   }
   ```

2. **Password Change Required**:
   ```json
   {
     "status": "success", 
     "message": "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô",
     "requirePasswordChange": true,
     "user": { /* user object without sensitive data */ }
   }
   ```

3. **Error**:
   ```json
   {
     "status": "error",
     "message": "error_message_here"
   }
   ```

---

#### **POST /exec?action=resetPassword**
**Purpose**: Reset user password (generates temporary password)

**Request Parameters**:
```javascript
{
  action: 'resetPassword',
  email: string
}
```

**Response**:
```json
{
  "status": "success",
  "message": "‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß",
  "empId": "EMP001",
  "email": "user@example.com"
}
```

---

#### **POST /exec?action=changePassword**
**Purpose**: Change user password (from temporary to permanent)

**Request Parameters**:
```javascript
{
  action: 'changePassword',
  empId: string,
  currentPassword: string,
  newPassword: string
}
```

**Response**:
```json
{
  "status": "success",
  "message": "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß"
}
```

---

## üíª Frontend Integration

### Complete Login Form Example

```html
<!DOCTYPE html>
<html>
<head>
    <title>Login System</title>
</head>
<body>
    <div id="loginForm">
        <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
        <input type="text" id="username" placeholder="Email ‡∏´‡∏£‡∏∑‡∏≠ ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô">
        <input type="password" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
        <button onclick="login()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
        <button onclick="showResetForm()">‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô?</button>
    </div>

    <div id="resetForm" style="display:none">
        <h2>‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h2>
        <input type="email" id="resetEmail" placeholder="Email">
        <button onclick="resetPassword()">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>
        <button onclick="showLoginForm()">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>

    <div id="changePasswordForm" style="display:none">
        <h2>‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h2>
        <input type="password" id="currentPassword" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô">
        <input type="password" id="newPassword" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà">
        <input type="password" id="confirmPassword" placeholder="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà">
        <button onclick="changePassword()">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>
    </div>

    <div id="message"></div>

    <script>
        const API_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec';
        let currentUser = null;

        async function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (!username || !password) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô', 'error');
                return;
            }

            try {
                showMessage('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...', 'info');

                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams({
                        action: 'login',
                        username: username,
                        password: password
                    })
                });

                const result = await response.json();

                if (result.status === 'success') {
                    if (result.requirePasswordChange) {
                        // Show password change form
                        currentUser = result.user;
                        showPasswordChangeForm();
                        showMessage('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô', 'warning');
                    } else {
                        // Normal login success
                        localStorage.setItem('authToken', result.token);
                        localStorage.setItem('userData', JSON.stringify(result.user));
                        showMessage('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                        // Redirect to main application
                        setTimeout(() => {
                            window.location.href = '/main.html';
                        }, 1500);
                    }
                } else {
                    showMessage(result.message, 'error');
                }
            } catch (error) {
                showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠', 'error');
                console.error('Login error:', error);
            }
        }

        async function resetPassword() {
            const email = document.getElementById('resetEmail').value;

            if (!email) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•', 'error');
                return;
            }

            try {
                showMessage('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô...', 'info');

                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams({
                        action: 'resetPassword',
                        email: email
                    })
                });

                const result = await response.json();

                if (result.status === 'success') {
                    showMessage('‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß "Init4321"', 'success');
                    showLoginForm();
                    // Auto-fill username for convenience
                    document.getElementById('username').value = email;
                    document.getElementById('password').value = 'Init4321';
                } else {
                    showMessage(result.message, 'error');
                }
            } catch (error) {
                showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô', 'error');
                console.error('Reset error:', error);
            }
        }

        async function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (!currentPassword || !newPassword || !confirmPassword) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á', 'error');
                return;
            }

            if (newPassword !== confirmPassword) {
                showMessage('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô', 'error');
                return;
            }

            if (newPassword.length < 6) {
                showMessage('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 6 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£', 'error');
                return;
            }

            try {
                showMessage('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô...', 'info');

                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams({
                        action: 'changePassword',
                        empId: currentUser.empId,
                        currentPassword: currentPassword,
                        newPassword: newPassword
                    })
                });

                const result = await response.json();

                if (result.status === 'success') {
                    showMessage('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà', 'success');
                    
                    // Auto-fill login form with new password
                    showLoginForm();
                    document.getElementById('username').value = currentUser.email;
                    document.getElementById('password').value = newPassword;
                    
                    currentUser = null;
                } else {
                    showMessage(result.message, 'error');
                }
            } catch (error) {
                showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô', 'error');
                console.error('Change password error:', error);
            }
        }

        function showLoginForm() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('resetForm').style.display = 'none';
            document.getElementById('changePasswordForm').style.display = 'none';
        }

        function showResetForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('resetForm').style.display = 'block';
            document.getElementById('changePasswordForm').style.display = 'none';
        }

        function showPasswordChangeForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('resetForm').style.display = 'none';
            document.getElementById('changePasswordForm').style.display = 'block';
            
            // Pre-fill current password if it's temporary
            if (currentUser) {
                document.getElementById('currentPassword').value = 'Init4321';
            }
        }

        function showMessage(message, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = message;
            messageDiv.className = type;

            // Auto-hide success/info messages
            if (type === 'success' || type === 'info') {
                setTimeout(() => {
                    messageDiv.textContent = '';
                    messageDiv.className = '';
                }, 5000);
            }
        }
    </script>

    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 400px;
            margin: 50px auto;
            padding: 20px;
        }

        div[id$="Form"] {
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 3px;
            box-sizing: border-box;
        }

        button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        #message {
            padding: 10px;
            margin: 10px 0;
            border-radius: 3px;
            text-align: center;
        }

        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }

        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</body>
</html>
```

---

## üîí Security Features

### 1. **Password Hashing**
```javascript
// Custom hashing function combining email and empId
function hashPassword(email, empId) {
  const passwordString = email.split('@')[0] + empId;
  return Utilities.computeDigest(Utilities.DigestAlgorithm.SHA_256, passwordString)
                  .map(b => (b < 0 ? b + 256 : b).toString(16).padStart(2, '0'))
                  .join('');
}
```

### 2. **Token Management**
```javascript
// Token creation with expiration
function createUserToken(user) {
  const tokenData = {
    empId: user.empId,
    email: user.email,
    role: user.role,
    timestamp: new Date().getTime(),
    expires: new Date().getTime() + (60 * 60 * 1000) // 1 hour
  };
  
  return base64Encode(JSON.stringify(tokenData));
}
```

### 3. **User Status Validation**
```javascript
// Check user status before authentication
const userStatus = row[CONFIG.COLUMNS.USER.USER_STATUS];
if (userStatus !== 1) {
  return {
    status: 'error',
    message: '‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô'
  };
}
```

---

## üìß Email Notifications

### Password Reset Email Template
```javascript
function sendPasswordResetEmail(email, fullName, tempPassword) {
  const subject = 'üîê ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô - Trading Journal System';
  
  const htmlBody = `
    <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
      <h2 style="color: #333;">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</h2>
      
      <p>‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ ‡∏Ñ‡∏∏‡∏ì${fullName},</p>
      
      <p>‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
      
      <div style="background-color: #f8f9fa; padding: 20px; border-radius: 5px; margin: 20px 0;">
        <h3 style="color: #007bff; margin-top: 0;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h3>
        <p><strong>Email:</strong> ${email}</p>
        <p><strong>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß:</strong> <code style="background: #e9ecef; padding: 5px; border-radius: 3px;">${tempPassword}</code></p>
      </div>
      
      <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; border-left: 4px solid #ffc107;">
        <h4 style="color: #856404; margin-top: 0;">‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h4>
        <ul style="color: #856404;">
          <li>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</li>
          <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å</li>
          <li>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏™‡∏π‡∏á</li>
        </ul>
      </div>
      
      <p style="margin-top: 30px;">
        <a href="#" style="background-color: #007bff; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
      </p>
      
      <hr style="margin: 30px 0; border: none; border-top: 1px solid #eee;">
      
      <p style="color: #666; font-size: 12px;">
        ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡∏ô‡∏ó‡∏µ<br>
        ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
      </p>
    </div>
  `;
  
  MailApp.sendEmail({
    to: email,
    subject: subject,
    htmlBody: htmlBody
  });
}
```

---

## üö® Error Handling

### Common Error Scenarios & Responses

#### 1. **Invalid Credentials**
```json
{
  "status": "error",
  "message": "‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"
}
```

#### 2. **User Not Found**
```json
{
  "status": "error", 
  "message": "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏µ email ‡∏ô‡∏µ‡πâ"
}
```

#### 3. **Account Disabled**
```json
{
  "status": "error",
  "message": "‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô"
}
```

#### 4. **Password Change Required**
```json
{
  "status": "success",
  "message": "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô",
  "requirePasswordChange": true,
  "user": { /* user data */ }
}
```

#### 5. **Current Password Incorrect**
```json
{
  "status": "error",
  "message": "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"
}
```

### Frontend Error Handling
```javascript
function handleApiResponse(result) {
  switch (result.status) {
    case 'success':
      if (result.requirePasswordChange) {
        showPasswordChangeForm(result.user);
      } else {
        handleLoginSuccess(result);
      }
      break;
      
    case 'error':
      showErrorMessage(result.message);
      
      // Handle specific error cases
      if (result.message.includes('‡∏£‡∏∞‡∏á‡∏±‡∏ö')) {
        disableLoginForm();
        showContactAdminMessage();
      }
      break;
      
    default:
      showErrorMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏');
  }
}
```

---

## üîß Troubleshooting

### Common Issues & Solutions

#### 1. **Login Always Fails**
```javascript
// Check: User status in Google Sheets
// Solution: Ensure Userstatus column = 1

// Debug function
function debugUserStatus(email) {
  const userInfo = findUserByEmail(email);
  console.log('User found:', userInfo);
  console.log('User status:', userInfo ? userInfo.status : 'N/A');
}
```

#### 2. **Password Reset Email Not Sent**
```javascript
// Check: Email permissions and MailApp quota
// Solution: Verify Google Apps Script email limits

// Debug function  
function testEmailSending(email) {
  try {
    MailApp.sendEmail({
      to: email,
      subject: 'Test Email',
      body: 'This is a test email from your system.'
    });
    console.log('‚úÖ Email sent successfully');
  } catch (error) {
    console.error('‚ùå Email sending failed:', error);
  }
}
```

#### 3. **Password Change Always Required**
```javascript
// Check: requirePasswordChange column value
// Solution: Ensure proper boolean handling

// Debug function
function checkPasswordChangeFlag(empId) {
  const userRow = findUserRowByEmpId(empId);
  const flag = userRow[CONFIG.COLUMNS.USER.REQUIRE_PASSWORD_CHANGE];
  console.log('Password change required flag:', flag, typeof flag);
}
```

#### 4. **Token Validation Issues**
```javascript
// Check: Token expiration and format
// Solution: Verify token creation and validation logic

// Debug function
function validateTokenDebug(token) {
  try {
    const tokenData = JSON.parse(base64Decode(token));
    const now = new Date().getTime();
    const isExpired = now > tokenData.expires;
    
    console.log('Token data:', tokenData);
    console.log('Is expired:', isExpired);
    console.log('Time left:', (tokenData.expires - now) / 1000 / 60, 'minutes');
  } catch (error) {
    console.error('Invalid token format:', error);
  }
}
```

### System Health Check

```javascript
function performAuthSystemHealthCheck() {
  console.log('üîç Authentication System Health Check');
  
  const health = {
    timestamp: new Date().toISOString(),
    tests: []
  };
  
  // Test 1: Config availability
  health.tests.push({
    test: 'CONFIG availability',
    status: typeof CONFIG !== 'undefined' ? 'PASS' : 'FAIL'
  });
  
  // Test 2: User sheet access
  try {
    const userSheet = getSheet(CONFIG.SHEETS.USER);
    health.tests.push({
      test: 'User sheet access',
      status: userSheet ? 'PASS' : 'FAIL'
    });
  } catch (error) {
    health.tests.push({
      test: 'User sheet access',
      status: 'FAIL',
      error: error.toString()
    });
  }
  
  // Test 3: Password hashing
  try {
    const hash = hashPassword('test@example.com', 'EMP001');
    health.tests.push({
      test: 'Password hashing',
      status: hash && hash.length > 0 ? 'PASS' : 'FAIL'
    });
  } catch (error) {
    health.tests.push({
      test: 'Password hashing',
      status: 'FAIL',
      error: error.toString()
    });
  }
  
  // Test 4: Email functionality
  try {
    const quotaRemaining = MailApp.getRemainingDailyQuota();
    health.tests.push({
      test: 'Email quota',
      status: quotaRemaining > 0 ? 'PASS' : 'FAIL',
      details: `${quotaRemaining} emails remaining`
    });
  } catch (error) {
    health.tests.push({
      test: 'Email quota',
      status: 'FAIL',
      error: error.toString()
    });
  }
  
  console.log('Health Check Results:', health);
  return health;
}
```

---

## üìä System Flow Diagram

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Frontend      ‚îÇ    ‚îÇ    Backend      ‚îÇ    ‚îÇ  Google Sheets  ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ 1. Login Form   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ authenticateUser‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Find user       ‚îÇ
‚îÇ   - username    ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ Verify password ‚îÇ
‚îÇ   - password    ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ Check status    ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ                 ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÇ Return result   ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÇ                 ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ + token/user    ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ OR              ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ + requirePwdChg ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ 2. Reset Form   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ resetPassword   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Find user       ‚îÇ
‚îÇ   - email       ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ Update password ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ Set flags       ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ                 ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÇ Send email      ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ "Init4321"      ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ 3. Change Form  ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ changePassword  ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Verify current  ‚îÇ
‚îÇ   - current     ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ Update new      ‚îÇ
‚îÇ   - new         ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ Clear flags     ‚îÇ
‚îÇ   - confirm     ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ                 ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÇ Success         ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÇ                 ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üéØ Best Practices

### 1. **Frontend Security**
- Always validate inputs before sending
- Use HTTPS for all authentication requests
- Store tokens securely (consider httpOnly cookies)
- Implement client-side session timeout
- Clear sensitive data from memory

### 2. **Backend Security**
- Hash passwords with salt (user-specific)
- Implement rate limiting for login attempts
- Log authentication events
- Validate all input parameters
- Use prepared statements equivalent

### 3. **User Experience**
- Provide clear error messages
- Show loading states during requests
- Auto-fill forms when appropriate
- Guide users through password reset process
- Implement session management

### 4. **Production Deployment**
- Monitor authentication logs
- Set up alerting for failed login attempts
- Regular security audits
- Backup user data
- Test recovery procedures

---

*Generated on: September 30, 2025*  
*Authentication System Version: SAP-Style v2.0*